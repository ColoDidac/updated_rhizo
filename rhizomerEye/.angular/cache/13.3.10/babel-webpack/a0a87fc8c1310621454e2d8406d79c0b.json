{"ast":null,"code":"import { ActivatedRoute, Router } from '@angular/router';\nimport { DatasetService } from '../../dataset/dataset.service';\nimport { Resource } from '../resource';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../dataset/dataset.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"ckeditor4-angular\";\n\nconst _c0 = function (a0) {\n  return {\n    uri: a0\n  };\n};\n\nfunction EditResourceComponent_div_1_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵelement(1, \"i\", 7);\n    i0.ɵɵelementStart(2, \"i\", 8);\n    i0.ɵɵlistener(\"click\", function EditResourceComponent_div_1_div_1_Template_i_click_2_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext(2);\n      return ctx_r3.saveContent();\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"routerLink\", \"../resource\")(\"queryParams\", i0.ɵɵpureFunction1(2, _c0, ctx_r2.resourceUri));\n  }\n}\n\nconst _c1 = function (a0, a1) {\n  return {\n    \"col-md-4 m-0\": a0,\n    \"col-12 m-0\": a1\n  };\n};\n\nfunction EditResourceComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 3);\n    i0.ɵɵtemplate(1, EditResourceComponent_div_1_div_1_Template, 3, 4, \"div\", 4);\n    i0.ɵɵelementStart(2, \"textarea\", 5);\n    i0.ɵɵlistener(\"ngModelChange\", function EditResourceComponent_div_1_Template_textarea_ngModelChange_2_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.jsonld = $event;\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(3, _c1, ctx_r0.resource.anonBody, !ctx_r0.resource.anonBody));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.resource.anonBody);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.jsonld);\n  }\n}\n\nfunction EditResourceComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 9);\n    i0.ɵɵelementStart(1, \"div\", 6);\n    i0.ɵɵelementStart(2, \"i\", 10);\n    i0.ɵɵlistener(\"click\", function EditResourceComponent_div_2_Template_i_click_2_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.jsonld = ctx_r7.resource.asJsonLd();\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"i\", 7);\n    i0.ɵɵelementStart(4, \"i\", 8);\n    i0.ɵɵlistener(\"click\", function EditResourceComponent_div_2_Template_i_click_4_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.saveContent();\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"ckeditor\", 11);\n    i0.ɵɵlistener(\"dataChange\", function EditResourceComponent_div_2_Template_ckeditor_dataChange_5_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return ctx_r10.resource.anonBody.values[0].value = $event;\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"routerLink\", \"../resource\")(\"queryParams\", i0.ɵɵpureFunction1(4, _c0, ctx_r1.resourceUri));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"data\", ctx_r1.resource.anonBody.values[0].value)(\"config\", ctx_r1.editorConfig);\n  }\n}\n\nexport let EditResourceComponent = /*#__PURE__*/(() => {\n  class EditResourceComponent {\n    constructor(router, route, datasetService) {\n      this.router = router;\n      this.route = route;\n      this.datasetService = datasetService;\n      this.resource = new Resource();\n      this.anonResources = new Map();\n      this.labels = new Map();\n      this.editorConfig = {\n        extraPlugins: 'autogrow',\n        allowedContent: true\n      };\n      this.jsonld = '';\n\n      this.router.routeReuseStrategy.shouldReuseRoute = () => false;\n\n      const navigation = this.router.getCurrentNavigation();\n      this.resource = navigation.extras.state && navigation.extras.state.resource;\n    }\n\n    ngOnInit() {\n      this.datasetId = this.route.snapshot.paramMap.get('did') || 'default';\n      this.resourceUri = this.route.snapshot.queryParamMap.get('uri');\n\n      if (!this.resource) {\n        this.router.navigate(['../resource'], {\n          relativeTo: this.route,\n          queryParams: {\n            uri: this.resourceUri\n          }\n        });\n      } else {\n        this.jsonld = this.resource.asJsonLd();\n      }\n    }\n\n    saveContent() {\n      this.datasetService.updateDatasetResource(this.datasetId, this.resourceUri, this.jsonld).subscribe(() => this.router.navigate(['../resource'], {\n        relativeTo: this.route,\n        queryParams: {\n          uri: this.resourceUri\n        }\n      }));\n    }\n\n  }\n\n  EditResourceComponent.ɵfac = function EditResourceComponent_Factory(t) {\n    return new (t || EditResourceComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.DatasetService));\n  };\n\n  EditResourceComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: EditResourceComponent,\n    selectors: [[\"app-edit-resource\"]],\n    decls: 3,\n    vars: 2,\n    consts: [[\"id\", \"describe\", 1, \"row\"], [\"id\", \"localmetadata-edit\", 3, \"ngClass\", 4, \"ngIf\"], [\"id\", \"localcontent-edit\", \"class\", \"col-md-8 m-0\", 4, \"ngIf\"], [\"id\", \"localmetadata-edit\", 3, \"ngClass\"], [\"class\", \"text-right\", 4, \"ngIf\"], [\"rows\", \"64\", 1, \"form-control\", 2, \"font-size\", \"x-small\", 3, \"ngModel\", \"ngModelChange\"], [1, \"text-right\"], [1, \"resource-btn\", \"fa\", \"fa-close\", 3, \"routerLink\", \"queryParams\"], [1, \"resource-btn\", \"fa\", \"fa-save\", 3, \"click\"], [\"id\", \"localcontent-edit\", 1, \"col-md-8\", \"m-0\"], [1, \"resource-btn\", \"fa\", \"fa-refresh\", 3, \"click\"], [3, \"data\", \"config\", \"dataChange\"]],\n    template: function EditResourceComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, EditResourceComponent_div_1_Template, 3, 6, \"div\", 1);\n        i0.ɵɵtemplate(2, EditResourceComponent_div_2_Template, 6, 6, \"div\", 2);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.resource && ctx.resource[\"@id\"]);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.resource && ctx.resource.anonBody);\n      }\n    },\n    directives: [i3.NgIf, i3.NgClass, i1.RouterLink, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgModel, i5.CKEditorComponent],\n    styles: [\".resource-btn[_ngcontent-%COMP%]{cursor:pointer;margin-left:.5em}\"]\n  });\n  return EditResourceComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}